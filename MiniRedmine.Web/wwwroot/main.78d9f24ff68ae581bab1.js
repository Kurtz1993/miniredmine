(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{248:function(e,t,a){var n={"./af":76,"./af.js":76,"./ar":77,"./ar-dz":78,"./ar-dz.js":78,"./ar-kw":79,"./ar-kw.js":79,"./ar-ly":80,"./ar-ly.js":80,"./ar-ma":81,"./ar-ma.js":81,"./ar-sa":82,"./ar-sa.js":82,"./ar-tn":83,"./ar-tn.js":83,"./ar.js":77,"./az":84,"./az.js":84,"./be":85,"./be.js":85,"./bg":86,"./bg.js":86,"./bm":87,"./bm.js":87,"./bn":88,"./bn.js":88,"./bo":89,"./bo.js":89,"./br":90,"./br.js":90,"./bs":91,"./bs.js":91,"./ca":92,"./ca.js":92,"./cs":93,"./cs.js":93,"./cv":94,"./cv.js":94,"./cy":95,"./cy.js":95,"./da":96,"./da.js":96,"./de":97,"./de-at":98,"./de-at.js":98,"./de-ch":99,"./de-ch.js":99,"./de.js":97,"./dv":100,"./dv.js":100,"./el":101,"./el.js":101,"./en-SG":102,"./en-SG.js":102,"./en-au":103,"./en-au.js":103,"./en-ca":104,"./en-ca.js":104,"./en-gb":105,"./en-gb.js":105,"./en-ie":106,"./en-ie.js":106,"./en-il":107,"./en-il.js":107,"./en-nz":108,"./en-nz.js":108,"./eo":109,"./eo.js":109,"./es":110,"./es-do":111,"./es-do.js":111,"./es-us":112,"./es-us.js":112,"./es.js":110,"./et":113,"./et.js":113,"./eu":114,"./eu.js":114,"./fa":115,"./fa.js":115,"./fi":116,"./fi.js":116,"./fo":117,"./fo.js":117,"./fr":118,"./fr-ca":119,"./fr-ca.js":119,"./fr-ch":120,"./fr-ch.js":120,"./fr.js":118,"./fy":121,"./fy.js":121,"./ga":122,"./ga.js":122,"./gd":123,"./gd.js":123,"./gl":124,"./gl.js":124,"./gom-latn":125,"./gom-latn.js":125,"./gu":126,"./gu.js":126,"./he":127,"./he.js":127,"./hi":128,"./hi.js":128,"./hr":129,"./hr.js":129,"./hu":130,"./hu.js":130,"./hy-am":131,"./hy-am.js":131,"./id":132,"./id.js":132,"./is":133,"./is.js":133,"./it":134,"./it-ch":135,"./it-ch.js":135,"./it.js":134,"./ja":136,"./ja.js":136,"./jv":137,"./jv.js":137,"./ka":138,"./ka.js":138,"./kk":139,"./kk.js":139,"./km":140,"./km.js":140,"./kn":141,"./kn.js":141,"./ko":142,"./ko.js":142,"./ku":143,"./ku.js":143,"./ky":144,"./ky.js":144,"./lb":145,"./lb.js":145,"./lo":146,"./lo.js":146,"./lt":147,"./lt.js":147,"./lv":148,"./lv.js":148,"./me":149,"./me.js":149,"./mi":150,"./mi.js":150,"./mk":151,"./mk.js":151,"./ml":152,"./ml.js":152,"./mn":153,"./mn.js":153,"./mr":154,"./mr.js":154,"./ms":155,"./ms-my":156,"./ms-my.js":156,"./ms.js":155,"./mt":157,"./mt.js":157,"./my":158,"./my.js":158,"./nb":159,"./nb.js":159,"./ne":160,"./ne.js":160,"./nl":161,"./nl-be":162,"./nl-be.js":162,"./nl.js":161,"./nn":163,"./nn.js":163,"./pa-in":164,"./pa-in.js":164,"./pl":165,"./pl.js":165,"./pt":166,"./pt-br":167,"./pt-br.js":167,"./pt.js":166,"./ro":168,"./ro.js":168,"./ru":169,"./ru.js":169,"./sd":170,"./sd.js":170,"./se":171,"./se.js":171,"./si":172,"./si.js":172,"./sk":173,"./sk.js":173,"./sl":174,"./sl.js":174,"./sq":175,"./sq.js":175,"./sr":176,"./sr-cyrl":177,"./sr-cyrl.js":177,"./sr.js":176,"./ss":178,"./ss.js":178,"./sv":179,"./sv.js":179,"./sw":180,"./sw.js":180,"./ta":181,"./ta.js":181,"./te":182,"./te.js":182,"./tet":183,"./tet.js":183,"./tg":184,"./tg.js":184,"./th":185,"./th.js":185,"./tl-ph":186,"./tl-ph.js":186,"./tlh":187,"./tlh.js":187,"./tr":188,"./tr.js":188,"./tzl":189,"./tzl.js":189,"./tzm":190,"./tzm-latn":191,"./tzm-latn.js":191,"./tzm.js":190,"./ug-cn":192,"./ug-cn.js":192,"./uk":193,"./uk.js":193,"./ur":194,"./ur.js":194,"./uz":195,"./uz-latn":196,"./uz-latn.js":196,"./uz.js":195,"./vi":197,"./vi.js":197,"./x-pseudo":198,"./x-pseudo.js":198,"./yo":199,"./yo.js":199,"./zh-cn":200,"./zh-cn.js":200,"./zh-hk":201,"./zh-hk.js":201,"./zh-tw":202,"./zh-tw.js":202};function r(e){var t=s(e);return a(t)}function s(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id=248},373:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(50),l=a.n(s),i=a(28),c=a(24),m=a(229),u=a(1),o=a.n(u),d=a(228),h=a.n(d),f={isAuthenticated:!1,_userInfo:{},_timeEntryActivities:[],_dateArray:[],signIn:function(e,t,a){this._userInfo=t,this._timeEntryActivities=a,localStorage.setItem("RedmineApiToken",e),this.isAuthenticated=!0},signout:function(){this.isAuthenticated=!1,this._userInfo={},this._timeEntryActivities=[]},getApiKey:function(){return localStorage.getItem("RedmineApiToken")||""},getUserInfo:function(){return this.isAuthenticated?this._userInfo:{}},getTimeEntryActivities:function(){return this.isAuthenticated?this._timeEntryActivities:[]},getTimeEntryActivityById:function(e){var t=new Number(e);return this.isAuthenticated?h()(this._timeEntryActivities,{id:t}):{name:""}},getUserTemplates:function(){return JSON.parse(localStorage.getItem("MiniRedmineTemplates")||"[]")},getDateArray:function(e,t){if(this._dateArray.length&&this._dateArray[0].format("YYYY-MM-DD")===e)return this._dateArray;this._dateArray=[];var a=o()(e,"YYYY-MM-DD"),n=o()(t,"YYYY-MM-DD");do{this._dateArray.push(a.clone()),a.add(1,"days")}while(!1===a.isAfter(n));return this._dateArray}};var j=function(){var e=f.getUserInfo();return r.a.createElement(m.a,null,r.a.createElement("h1",null,"Welcome!"),r.a.createElement("p",null,e.firstName," ",e.lastName))},p=a(69),v=a.n(p),y=a(231),E=a.n(y),g=a(20),b=a.n(g),I=a(33),A=a.n(I),k=a(14),C=a(7),Y=a(6),S=a(72),w=a(29);var T=function(){var e=Object(n.useState)(f.getApiKey()),t=b()(e,2),a=t[0],s=t[1],l=Object(c.g)(),i=(Object(c.h)().state||{from:{pathname:"/"}}).from,m=function(){return l.replace(i)};function u(){return(u=E()(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""===a){e.next=10;break}return e.next=4,A.a.get("api/redmine/userinfo?userApiKey=".concat(a));case 4:return n=e.sent,e.next=7,A.a.get("api/redmine/timeentryactivities?userApiKey=".concat(a));case 7:r=e.sent,f.signIn(a,n.data,r.data),m();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement(w.a,{fluid:"true"},r.a.createElement(Y.a,{onSubmit:function(e){return u.apply(this,arguments)}},r.a.createElement(Y.a.Row,null,r.a.createElement(Y.a.Group,{as:C.a},r.a.createElement(S.a,null,r.a.createElement(Y.a.Control,{type:"text",placeholder:"Redmine Api Token",value:a,onChange:function(e){return s(e.target.value)}}),r.a.createElement(S.a.Append,null,r.a.createElement(k.a,{variant:"primary",type:"submit"},"Login")))))))},D=a(234),O=a.n(D),M=a(235),z=a.n(M);var x=function(e){var t=e.children,a=z()(e,["children"]);return r.a.createElement(c.b,O()({},a,{render:function(e){var a=e.location;return f.isAuthenticated?t:r.a.createElement(c.a,{to:{pathname:"/login",state:{from:a}}})}}))},N=a(236),_=a.n(N),H=a(74),R=a(26),L=a(31),F=a(17),G=a.n(F),K=a(51),U=a.n(K),J=a(237),B=a(21);var q=function(e){var t=e.entry,a=e.removeTask,n=e.handleChange,s=f.getTimeEntryActivities().map((function(e,t){return r.a.createElement("option",{key:t,value:e.id},e.name)}));return r.a.createElement(B.a,null,r.a.createElement(Y.a,null,r.a.createElement(Y.a.Row,null,r.a.createElement(Y.a.Group,{as:C.a},r.a.createElement(Y.a.Control,{type:"text",name:"IssueId",value:t.IssueId,onChange:n})),r.a.createElement(Y.a.Group,{as:C.a},r.a.createElement(Y.a.Control,{type:"text",name:"Comments",maxLength:"254",value:t.Comments,onChange:n}))),r.a.createElement(Y.a.Row,null,r.a.createElement(Y.a.Group,{as:C.a},r.a.createElement(Y.a.Control,{type:"number",name:"Hours",min:"0.0",max:"24",step:"0.1",value:t.Hours,onChange:n})),r.a.createElement(Y.a.Group,{as:C.a},r.a.createElement(Y.a.Control,{as:"select",value:t.ActivityId,name:"ActivityId",onChange:n},r.a.createElement("option",{key:-1,value:""},"--- Select Activity ---"),s)))),r.a.createElement(k.a,{size:"sm",variant:"danger",className:"float-right",onClick:a},r.a.createElement("i",{className:"fas fa-trash"})))};var P=function(e){var t=e.now,a=e.dateItem,s=e.userTimeEntries,l=e.userTemplates,i=e.saveTimeEntries,c=Object(n.useState)([]),m=b()(c,2),u=m[0],d=m[1];Object(n.useEffect)((function(){s.length>0?(console.log("From Item"),console.log(s),d([{Id:o()().unix(),IssueId:0,ActivityId:-1,Hours:1,Comments:"Comments"}])):d(l)}),[s]);var h=!1,f=r.a.createElement(r.a.Fragment,null),j=r.a.createElement(r.a.Fragment,null),p=s.map((function(e){return r.a.createElement(B.a,{key:e.id},"Issue: ",e.issue.id," | Hours: ",e.hours," | ",e.activity.name," | ",e.comments," ")}));t.isAfter(a)&&(f=u.map((function(e,t){return r.a.createElement(q,{key:t,entry:e,handleChange:function(e){return function(e,t){var a=t<0?[{}]:Array.from(u),n=e.target.name,r=a[t<0?0:t];if("IssueId"===n)try{var s=parseInt(e.target.value);r=Object.assign(r,G()({},n,s))}catch(e){console.warn("Only numbers allowed")}else if("ActivityId"===n)try{var l=parseInt(e.target.value);r=Object.assign(r,G()({},n,l))}catch(e){console.warn("Only numbers allowed")}else if("Hours"===n)try{var i=parseFloat(e.target.value);r=Object.assign(r,G()({},n,i))}catch(e){console.warn("Only numbers allowed")}else r=Object.assign(r,G()({},n,e.target.value));a[t]=r,d(a)}(e,t)},removeTask:function(){return function(e){var t=Array.from(u);t.length>1&&(t.splice(e,1),d(t))}(t)}})})),h=!0),h&&(j=r.a.createElement(C.a,null,r.a.createElement(J.a,{vertical:!0},r.a.createElement(k.a,{variant:"secondary",onClick:function(e){var t={Id:o()().unix(),IssueId:0,ActivityId:-1,Hours:1,Comments:"Comments"},a=U()(u,t);d(a)}},"Add Task"),r.a.createElement(k.a,{variant:"success",onClick:function(){i(a.format("YYYY-MM-DD"),u)}},"Save"))));var v=6===a.day()||0===a.day()?"danger":"primary";return r.a.createElement(B.a,{variant:v},r.a.createElement("h6",null,a.format("dddd")," ",r.a.createElement("small",null,a.format("YYYY-MM-DD"))),r.a.createElement(L.a,null,r.a.createElement(C.a,{xs:10},r.a.createElement(R.a,null,p),r.a.createElement(R.a,null,f)),j))};var V=function(){var e=Object(n.useState)([]),t=b()(e,2),a=t[0],s=t[1],l=Object(n.useState)({show:!1}),i=b()(l,2),c=i[0],m=i[1],u=o()(),d=u.year(),h=u.month(),j=u.date(),p=j>=16?o()().year(d).month(h).date(16).format("YYYY-MM-DD"):o()().year(d).month(h).date(1).format("YYYY-MM-DD"),v=j>=16?o()().year(d).month(h).date(1).add(1,"months").subtract(1,"days").format("YYYY-MM-DD"):o()().year(d).month(h).date(15).format("YYYY-MM-DD"),y=f.getDateArray(p,v),E=f.getUserTemplates();function g(e,t){A.a.post("api/redmine/timeentries?userApiKey=".concat(f.getApiKey(),"&spentOn=").concat(e),t).then((function(e){console.log(a);var t=a.concat(e.data);console.log(t),s(t)}),(function(e){m({error:e.response.data,show:!0})}))}Object(n.useEffect)((function(){var e=f.getUserInfo();A.a.get("api/redmine/timeentries?userApiKey=".concat(f.getApiKey(),"&userId=").concat(e.id,"&from=").concat(p,"&to=").concat(v)).then((function(e){return s(e.data)}))}),[]);var I=y.map((function(e,t){var n=_()(a,{spent_on:e.format("YYYY-MM-DD")});return r.a.createElement(P,{key:t,now:u,dateItem:e,userTimeEntries:n,userTemplates:E,saveTimeEntries:g})})),k=r.a.createElement(r.a.Fragment,null);return c.show&&(k=r.a.createElement(H.a,{variant:"danger",onClose:function(){return m({show:!1})},dismissible:!0},r.a.createElement(H.a.Heading,null,"Oh snap! You got an error!"),r.a.createElement("p",null,JSON.stringify(c.error,null,2)))),r.a.createElement(w.a,null,r.a.createElement("h1",{className:"page-header"},r.a.createElement("i",{className:"far fa-calendar-alt"})," Simple Capture"),k,r.a.createElement(L.a,null,r.a.createElement(C.a,null,r.a.createElement(R.a,null,I))))},W=a(238),Q=a.n(W),X=a(243),Z=a(239),$=a.n(Z),ee=a(240),te=a.n(ee),ae=a(55),ne=a.n(ae),re=a(241),se=a.n(re),le=a(73),ie=a.n(le),ce=a(242),me=a.n(ce);var ue=function(e){var t=e.timeEntryActivities.map((function(e,t){return r.a.createElement("option",{key:t,value:e.id},e.name)}));return r.a.createElement(Y.a.Control,{as:"select",defaultValue:e.selectedActivity,name:e.name,onChange:e.onChange},r.a.createElement("option",{key:-1,value:""},"--- Select Activity ---"),t)};function oe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var de=function(e){me()(n,e);var t,a=(t=n,function(){var e,a=ie()(t);if(oe()){var n=ie()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return se()(this,e)});function n(e){var t;return $()(this,n),(t=a.call(this,e)).state={Id:-1,IssueId:0,Comments:"",ActivityId:-1,Hours:0},t.handleChange=t.handleChange.bind(ne()(t)),t.handleSubmit=t.handleSubmit.bind(ne()(t)),t}return te()(n,[{key:"handleChange",value:function(e){var t=e.target.name;"IssueId"===t||"ActivityId"===t?this.setState(G()({},t,parseInt(e.target.value))):"Hours"===t?this.setState(G()({},t,parseFloat(e.target.value))):this.setState(G()({},t,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.addTemplate({Id:o()().unix(),IssueId:this.state.IssueId,Comments:this.state.Comments,ActivityId:this.state.ActivityId,Hours:this.state.Hours})}},{key:"render",value:function(){return r.a.createElement(Y.a,{onSubmit:this.handleSubmit},r.a.createElement(Y.a.Group,null,r.a.createElement(Y.a.Label,null,"Issue"),r.a.createElement(Y.a.Control,{type:"text",name:"IssueId",onChange:this.handleChange}),r.a.createElement(Y.a.Label,null,"Comments"),r.a.createElement(Y.a.Control,{type:"text",name:"Comments",onChange:this.handleChange}),r.a.createElement(Y.a.Label,null,"Activity"),r.a.createElement(ue,{name:"ActivityId",timeEntryActivities:f.getTimeEntryActivities(),onChange:this.handleChange}),r.a.createElement(Y.a.Label,null,"Hours"),r.a.createElement(Y.a.Control,{type:"number",name:"Hours",min:"0",max:"8",step:"0.1",onChange:this.handleChange}),r.a.createElement(k.a,{type:"submit",variant:"success"},"Save")))}}]),n}(r.a.Component);var he=function(){var e=Object(n.useState)(JSON.parse(localStorage.getItem("MiniRedmineTemplates")||"[]")),t=b()(e,2),a=t[0],s=t[1],l=a.map((function(e,t){return r.a.createElement(B.a,{key:e.Id},e.IssueId," | ",f.getTimeEntryActivityById(e.ActivityId).name," |",e.Comments," | ",e.Hours," | ",r.a.createElement(k.a,{type:"button",variant:"danger",onClick:function(){return function(e){var t=Array.from(a);t.splice(e,1),s(t),localStorage.setItem("MiniRedmineTemplates",JSON.stringify(t))}(t)}},r.a.createElement("i",{className:"fas fa-trash"})))})),i=Q()(a,(function(e){return new Number(e.Hours)})).toString(),c=i>0?r.a.createElement("h3",null,"Total Hours ",r.a.createElement(X.a,{variant:"primary"},i)):r.a.createElement(r.a.Fragment,null);return r.a.createElement(w.a,null,r.a.createElement("h2",{className:"mb-3"},"Templates"),r.a.createElement(L.a,null,r.a.createElement(C.a,null,r.a.createElement(de,{addTemplate:function(e){var t=U()(a,e);s(t),localStorage.setItem("MiniRedmineTemplates",JSON.stringify(t))}})),r.a.createElement(C.a,null,c,r.a.createElement(R.a,null,l))))},fe=function(){return r.a.createElement(c.d,null,r.a.createElement(c.b,{path:"/Login"},r.a.createElement(T,null)),r.a.createElement(x,{exact:!0,path:"/"},r.a.createElement(j,null)),r.a.createElement(x,{path:"/SimpleCapture"},r.a.createElement(V,null)),r.a.createElement(x,{path:"/Templates"},r.a.createElement(he,null)))},je=a(39),pe=a(34);var ve=function(){var e=Object(c.g)(),t=r.a.createElement(r.a.Fragment,null);if(f.isAuthenticated){var a=f.getUserInfo();t=r.a.createElement(pe.a.Text,null,"Hello ",a.firstName," ",a.lastName)}return r.a.createElement(pe.a,{bg:"primary",className:"mb-3"},r.a.createElement(pe.a.Brand,{onClick:function(){return e.push("/")}},"MiniRedmine 2"),r.a.createElement(pe.a.Toggle,{"aria-controls":"main-navbar-nav"}),r.a.createElement(pe.a.Collapse,{id:"main-navbar-nav"},r.a.createElement(je.a,{className:"mr-auto"},r.a.createElement(je.a.Link,{onClick:function(){return e.push("/SimpleCapture")}},"Simple Capture")),r.a.createElement(je.a,{className:"mr-auto"},r.a.createElement(je.a.Link,{onClick:function(){return e.push("/Templates")}},"Templates"))),t)},ye=function(){return r.a.createElement(i.a,null,r.a.createElement(ve,null),r.a.createElement(fe,null))};l.a.render(r.a.createElement(ye,null),document.getElementById("miniredmine2"))}},[[373,1,2]]]);
//# sourceMappingURL=main.78d9f24ff68ae581bab1.js.map